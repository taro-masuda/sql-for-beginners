SELECT
    user_id
    , id
    , price
    , LEAD(price, 1) OVER(PARTITION BY user_id ORDER BY id) AS lead1_price
    , LEAD(price, 2) OVER(PARTITION BY user_id ORDER BY id) AS lead2_price
FROM 
    receipt_item
WHERE user_id <= 3;
/*
 user_id |   id   | price | lead1_price | lead2_price 
---------+--------+-------+-------------+-------------
       1 |     27 |   300 |         350 |         200
       1 |     28 |   350 |         200 |         100
       1 |     29 |   200 |         100 |         100
       1 |     30 |   100 |         100 |         800
       1 |     31 |   100 |         800 |         150
       1 |   6803 |   800 |         150 |         100
       1 |   6804 |   150 |         100 |         300
       1 |   6805 |   100 |         300 |         100
       1 |  11712 |   300 |         100 |        1000
       1 |  11713 |   100 |        1000 |         130
       1 |  11714 |  1000 |         130 |        1200
       1 |  11715 |   130 |        1200 |         500
       1 |  11716 |  1200 |         500 |         100
       1 |  11717 |   500 |         100 |         300
       1 |  12913 |   100 |         300 |         150
       1 |  12914 |   300 |         150 |         300
       1 |  12915 |   150 |         300 |         200
       1 |  12916 |   300 |         200 |         100
       1 |  18117 |   200 |         100 |         100
       1 |  18118 |   100 |         100 |        1000
       1 |  18119 |   100 |        1000 |         250
       1 |  18120 |  1000 |         250 |         100
       1 |  18121 |   250 |         100 |         100
       1 |  18122 |   100 |         100 |         150
       1 |  23788 |   100 |         150 |         350
       1 |  23789 |   150 |         350 |        1000
       1 |  23790 |   350 |        1000 |         200
       1 |  23791 |  1000 |         200 |         100
       1 |  27896 |   200 |         100 |         500
       1 |  27897 |   100 |         500 |         100
       1 |  27898 |   500 |         100 |         250
       1 |  30315 |   100 |         250 |         300
       1 |  30316 |   250 |         300 |        2000
       1 |  30317 |   300 |        2000 |         100
       1 |  30318 |  2000 |         100 |         100
       1 |  30922 |   100 |         100 |         400
       1 |  30923 |   100 |         400 |         200
       1 |  30924 |   400 |         200 |         100
       1 |  42964 |   200 |         100 |         120
       1 |  42965 |   100 |         120 |         200
       1 |  42966 |   120 |         200 |         120
       1 |  69179 |   200 |         120 |         300
       1 |  69180 |   120 |         300 |         100
       1 |  69181 |   300 |         100 |         100
       1 |  69182 |   100 |         100 |         150
       1 |  69183 |   100 |         150 |         100
       1 |  69184 |   150 |         100 |         100
       1 |  71147 |   100 |         100 |         130
       1 |  71148 |   100 |         130 |         150
       1 |  71149 |   130 |         150 |         800
       1 |  71150 |   150 |         800 |         100
       1 |  71151 |   800 |         100 |         120
       1 |  71152 |   100 |         120 |         100
       1 | 108952 |   120 |         100 |         100
       1 | 108953 |   100 |         100 |         100
       1 | 113240 |   100 |         100 |         130
       1 | 113241 |   100 |         130 |         250
       1 | 130185 |   130 |         250 |         250
       1 | 130186 |   250 |         250 |         100
       1 | 130187 |   250 |         100 |            
       1 | 130188 |   100 |             |            
       2 |      1 |   100 |        1000 |         500
       2 |      2 |  1000 |         500 |         250
       2 |      3 |   500 |         250 |        1000
       2 |      4 |   250 |        1000 |         100
       2 |     20 |  1000 |         100 |         100
       2 |     21 |   100 |         100 |         300
       2 |     22 |   100 |         300 |         300
       2 |     37 |   300 |         300 |         120
       2 |     38 |   300 |         120 |         300
       2 |     39 |   120 |         300 |         500
       2 |     40 |   300 |         500 |         100
       2 |     41 |   500 |         100 |         500
       2 |     42 |   100 |         500 |         100
       2 |     49 |   500 |         100 |         300
       2 |     50 |   100 |         300 |         500
       2 |     51 |   300 |         500 |        1000
       2 |     52 |   500 |        1000 |         500
       2 |     73 |  1000 |         500 |         150
       2 |     74 |   500 |         150 |         100
       2 |     75 |   150 |         100 |         500
       2 |     76 |   100 |         500 |         100
       2 |     77 |   500 |         100 |         800
       2 |    122 |   100 |         800 |         150
       2 |    123 |   800 |         150 |         100
       2 |    124 |   150 |         100 |         900
       2 |    125 |   100 |         900 |        1000
       2 |    126 |   900 |        1000 |         150
       2 |    156 |  1000 |         150 |         500
       2 |    157 |   150 |         500 |         200
       2 |    158 |   500 |         200 |          50
       2 |    159 |   200 |          50 |        1500
       2 |    160 |    50 |        1500 |         100
       2 |    161 |  1500 |         100 |        1000
       2 |    162 |   100 |        1000 |         100
       2 |    163 |  1000 |         100 |         300
       2 |    164 |   100 |         300 |        1000
       2 |    165 |   300 |        1000 |         300
       2 |    176 |  1000 |         300 |         120
       2 |    177 |   300 |         120 |         150
       2 |    178 |   120 |         150 |         500
       2 |    187 |   150 |         500 |        1000
       2 |    188 |   500 |        1000 |         100
       2 |    189 |  1000 |         100 |         150
       2 |    190 |   100 |         150 |        1000
       2 |    191 |   150 |        1000 |         100
       2 |    223 |  1000 |         100 |         500
       2 |    224 |   100 |         500 |        1000
       2 |    256 |   500 |        1000 |         150
       2 |    262 |  1000 |         150 |         150
       2 |    263 |   150 |         150 |        1200
       2 |    264 |   150 |        1200 |         100
       2 |    265 |  1200 |         100 |         150
       2 |    266 |   100 |         150 |         200
       2 |    267 |   150 |         200 |         350
       2 |    268 |   200 |         350 |         300
       2 |    269 |   350 |         300 |         300
       2 |    283 |   300 |         300 |         100
       2 |    284 |   300 |         100 |         100
       2 |    285 |   100 |         100 |         500
       2 |    286 |   100 |         500 |         100
       2 |    416 |   500 |         100 |         350
       2 |    417 |   100 |         350 |        1200
       2 |    418 |   350 |        1200 |         500
       2 |    530 |  1200 |         500 |          50
       2 |    531 |   500 |          50 |         500
       2 |    532 |    50 |         500 |         350
       2 |    533 |   500 |         350 |         150
       2 |    534 |   350 |         150 |         150
       2 |    535 |   150 |         150 |         500
       2 |    580 |   150 |         500 |         140
       2 |    581 |   500 |         140 |         300
       2 |    602 |   140 |         300 |         100
       2 |    603 |   300 |         100 |         300
       2 |    604 |   100 |         300 |         300
       2 |    662 |   300 |         300 |         100
       2 |    663 |   300 |         100 |         200
       2 |    664 |   100 |         200 |         400
       2 |    665 |   200 |         400 |         100
       2 |    666 |   400 |         100 |         100
       2 |    667 |   100 |         100 |         300
       2 |    668 |   100 |         300 |         100
       2 |    669 |   300 |         100 |         100
       2 |    670 |   100 |         100 |         100
       2 |    671 |   100 |         100 |         100
       2 |    672 |   100 |         100 |         500
       2 |    696 |   100 |         500 |         150
       2 |    697 |   500 |         150 |        1000
       2 |    698 |   150 |        1000 |         150
       2 |    699 |  1000 |         150 |         130
       2 |    700 |   150 |         130 |         200
       2 |    701 |   130 |         200 |          50
       2 |    720 |   200 |          50 |         300
       2 |    721 |    50 |         300 |         350
       2 |    722 |   300 |         350 |         180
       2 |    723 |   350 |         180 |        1000
       2 |    724 |   180 |        1000 |         350
       2 |    725 |  1000 |         350 |         500
       2 |    757 |   350 |         500 |         200
       2 |    758 |   500 |         200 |         100
       2 |    759 |   200 |         100 |         180
       2 |    760 |   100 |         180 |        1000
       2 |   1004 |   180 |        1000 |         250
       2 |   1005 |  1000 |         250 |         150
       2 |   1006 |   250 |         150 |         500
       2 |   1007 |   150 |         500 |         100
       2 |   1015 |   500 |         100 |         100
       2 |   1016 |   100 |         100 |         130
       2 |   1017 |   100 |         130 |         200
       2 |   1106 |   130 |         200 |         100
       2 |   1107 |   200 |         100 |         100
       2 |   1108 |   100 |         100 |         350
       2 |   1129 |   100 |         350 |        1000
       2 |   1130 |   350 |        1000 |         100
       2 |   1131 |  1000 |         100 |         100
       2 |   1132 |   100 |         100 |         100
       2 |   1133 |   100 |         100 |        2000
       2 |   1134 |   100 |        2000 |         100
       2 |   1178 |  2000 |         100 |         100
       2 |   1179 |   100 |         100 |         100
       2 |   1180 |   100 |         100 |         150
       2 |   1181 |   100 |         150 |         300
       2 |   1182 |   150 |         300 |         100
       2 |   1183 |   300 |         100 |         100
       2 |   1184 |   100 |         100 |         100
       2 |   1185 |   100 |         100 |         100
       2 |   1268 |   100 |         100 |         100
       2 |   1269 |   100 |         100 |         200
       2 |   1270 |   100 |         200 |         300
       2 |   1271 |   200 |         300 |         100
       2 |   1272 |   300 |         100 |         500
       2 |   1273 |   100 |         500 |         120
       2 |   1274 |   500 |         120 |         300
       2 |   1310 |   120 |         300 |         200
       2 |   1317 |   300 |         200 |         120
       2 |   1318 |   200 |         120 |         250
       2 |   1319 |   120 |         250 |         400
       2 |   1341 |   250 |         400 |         150
       2 |   1342 |   400 |         150 |         180
       2 |   1343 |   150 |         180 |         100
       2 |   1437 |   180 |         100 |         100
       2 |   1438 |   100 |         100 |         150
       2 |   1439 |   100 |         150 |        1000
       2 |   1502 |   150 |        1000 |         110
       2 |   1503 |  1000 |         110 |         300
       2 |   1504 |   110 |         300 |         500
       2 |   1505 |   300 |         500 |         100
       2 |   1522 |   500 |         100 |         500
       2 |   1523 |   100 |         500 |         700
       2 |   1524 |   500 |         700 |         120
       2 |   1525 |   700 |         120 |         500
       2 |   1526 |   120 |         500 |        1000
       2 |   1527 |   500 |        1000 |         700
       2 |   1546 |  1000 |         700 |         400
       2 |   1547 |   700 |         400 |         300
       2 |   1548 |   400 |         300 |         180
       2 |   1612 |   300 |         180 |         100
       2 |   1613 |   180 |         100 |         200
       2 |   1621 |   100 |         200 |        2000
       2 |   1694 |   200 |        2000 |         180
       2 |   1695 |  2000 |         180 |         100
       2 |   1696 |   180 |         100 |         120
       2 |   1706 |   100 |         120 |         500
       2 |   1707 |   120 |         500 |         900
       2 |   1708 |   500 |         900 |         100
       2 |   1919 |   900 |         100 |         120
       2 |   1920 |   100 |         120 |         300
       2 |   1921 |   120 |         300 |         100
       2 |   1922 |   300 |         100 |         300
       2 |   1939 |   100 |         300 |        1000
       2 |   1940 |   300 |        1000 |         100
       2 |   1941 |  1000 |         100 |        1000
       2 |   2165 |   100 |        1000 |         100
       2 |   2166 |  1000 |         100 |         100
       2 |   2169 |   100 |         100 |        1500
       2 |   2170 |   100 |        1500 |            
       2 |   2171 |  1500 |             |            
       3 |   3183 |   100 |         100 |         300
       3 |   3184 |   100 |         300 |         150
       3 |   3185 |   300 |         150 |         300
       3 |   3186 |   150 |         300 |         140
       3 |   3187 |   300 |         140 |         500
       3 |   4882 |   140 |         500 |         100
       3 |   4883 |   500 |         100 |         100
       3 |   5744 |   100 |         100 |         180
       3 |   5745 |   100 |         180 |         400
       3 |  11313 |   180 |         400 |         900
       3 |  11314 |   400 |         900 |         200
       3 |  17386 |   900 |         200 |        2000
       3 |  17387 |   200 |        2000 |         140
       3 |  17388 |  2000 |         140 |         200
       3 |  17389 |   140 |         200 |         150
       3 |  17390 |   200 |         150 |         800
       3 |  17391 |   150 |         800 |        1000
       3 |  23139 |   800 |        1000 |         400
       3 |  39126 |  1000 |         400 |         150
       3 |  39127 |   400 |         150 |         200
       3 |  46403 |   150 |         200 |         800
       3 |  46404 |   200 |         800 |        1000
       3 |  46405 |   800 |        1000 |         100
       3 |  46406 |  1000 |         100 |         100
       3 |  51080 |   100 |         100 |         500
       3 |  51081 |   100 |         500 |         150
       3 |  51082 |   500 |         150 |         350
       3 |  51177 |   150 |         350 |         100
       3 |  51178 |   350 |         100 |         700
       3 |  51179 |   100 |         700 |         180
       3 |  51180 |   700 |         180 |         300
       3 |  51181 |   180 |         300 |         110
       3 |  83390 |   300 |         110 |         150
       3 |  83391 |   110 |         150 |         200
       3 |  83392 |   150 |         200 |        1000
       3 |  87266 |   200 |        1000 |         500
       3 |  90297 |  1000 |         500 |         100
       3 |  90298 |   500 |         100 |         110
       3 |  90299 |   100 |         110 |        1000
       3 |  91705 |   110 |        1000 |         100
       3 |  91706 |  1000 |         100 |         200
       3 |  93239 |   100 |         200 |        1000
       3 |  93240 |   200 |        1000 |         100
       3 |  93241 |  1000 |         100 |         500
       3 | 162406 |   100 |         500 |        1200
       3 | 162407 |   500 |        1200 |         500
       3 | 162408 |  1200 |         500 |         100
       3 | 184925 |   500 |         100 |         500
       3 | 184926 |   100 |         500 |         100
       3 | 184927 |   500 |         100 |        2000
       3 | 184928 |   100 |        2000 |         100
       3 | 186078 |  2000 |         100 |         150
       3 | 186079 |   100 |         150 |         200
       3 | 196561 |   150 |         200 |         500
       3 | 196562 |   200 |         500 |         140
       3 | 196563 |   500 |         140 |         350
       3 | 196564 |   140 |         350 |         300
       3 | 196565 |   350 |         300 |         100
       3 | 196566 |   300 |         100 |         150
       3 | 196567 |   100 |         150 |         100
       3 | 196568 |   150 |         100 |         300
       3 | 227127 |   100 |         300 |         100
       3 | 227128 |   300 |         100 |         120
       3 | 227129 |   100 |         120 |         200
       3 | 227130 |   120 |         200 |            
       3 | 227131 |   200 |             |            
(303 rows)
*/